<html>

<head>
    <title>Services Monitoring</title>
    </style>
</head>

<body>
    <table id="myTable" style="width: 60%; margin: auto">
        <tbody>
            <tr>
                <td style="text-align:center"><textarea rows="5" cols="60" id="service0"></textarea><label
                        for="service0">refdata/version</label>
                    <p><input type="button" value="Получить дополнительную информацию" onclick="asd(1, 0)">
                        <input type="button" value="Скрыть" onclick="asd(0, 0)"></p>
                    <p>
                        <form id="asd0" action="">
                            <h1>HII insert some data</h1>
                        </form>
                    </p>
                </td>
                <td style="text-align:center"><textarea rows="5" cols="60" id="service1"></textarea><label
                        for="service1">ibonus/version</label>
                    <p><input type="button" value="Получить дополнительную информацию" onclick="asd(1, 1)">
                        <input type="button" value="Скрыть" onclick="asd(0, 1)"></p>
                    <p>
                        <form id="asd1" action="">
                            <h1>HII insert some data</h1>
                        </form>
                    </p>
                </td>
                <td style="text-align:center"><textarea rows="5" cols="60" id="service2"></textarea><label
                        for="service2">catalog/catalog</label>
                    <p><input type="button" value="Получить дополнительную информацию" onclick="asd(1, 2)">
                        <input type="button" value="Скрыть" onclick="asd(0, 2)"></p>
                    <p>
                        <form id="asd2" action="">
                            <h1>HII insert some data</h1>
                        </form>
                    </p>
                </td>
            </tr>
        </tbody>
    </table>

    <table style="width: 60%; margin: auto">
        <tbody>
            <tr>
                <td></td>
                <td>refdata</td>
                <td>ibonus</td>
                <td>catalog</td>
            </tr>
            <tr>
                <td>Имя сервиса:</td>
                <td id="sn0"></td>
                <td id="sn1"></td>
                <td id="sn2"></td>
            </tr>
            <tr>
                <td>Доступен: </td>
                <td id="ia0"></td>
                <td id="ia1"></td>
                <td id="ia2"></td>
            </tr>
            <tr>
                <td>Время ответа: </td>
                <td id="rd0"></td>
                <td id="rd1"></td>
                <td id="rd2"></td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <p><input type="button" value="Получить дополнительную информацию" onclick="asd(1, 0)">
                        <input type="button" value="Скрыть" onclick="asd(0, 0)"></p>
                </td>
                <td>
                    <p><input type="button" value="Получить дополнительную информацию" onclick="asd(1, 1)">
                        <input type="button" value="Скрыть" onclick="asd(0, 1)"></p>
                </td>
                <td>
                    <p><input type="button" value="Получить дополнительную информацию" onclick="asd(1, 2)">
                        <input type="button" value="Скрыть" onclick="asd(0, 2)"></p>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <p>
                        <form id="asd0" action="">
                            <h1>HII insert some data</h1>
                        </form>
                    </p>
                </td>
                <td>
                    <p>
                        <form id="asd1" action="">
                            <h1>HII insert some data</h1>
                        </form>
                    </p>
                </td>
                <td>
                    <p>
                        <form id="asd2" action="">
                            <h1>HII insert some data</h1>
                        </form>
                    </p>
                </td>
            </tr>
        </tbody>
    </table>

</body>
<script>
    window.addEventListener('load', callMethods, false);
    var arr = [];
    

    function insertText() {
        document.getElementById('sn0').value = arr[0].serviceName;
    }

    function callMethods() {
        document.getElementById("asd0").style.display = "none";
        document.getElementById("asd1").style.display = "none";
        document.getElementById("asd2").style.display = "none";


        for (var i = 0; i < 3; i++) {
            var response = callService(i);
            arr.push(response);
        }
        insertText;   
    };

    function callService(id) {
        var url = "https://localhost:44339/api/values/GetStatus?serviceId=" + id;
        var method = 'GET';
        var shouldBeAsync = true;
        var oXHR = new XMLHttpRequest();

        function append() {
            document.getElementById('service' + id).value = oXHR.responseText;
            var parsedResponse = JSON.parse(oXHR.responseText);
        }

        oXHR.onreadystatechange = append;
        oXHR.open(method, url, shouldBeAsync);
        oXHR.setRequestHeader("Content-Type", "application/json");
        oXHR.send();
        return parsedResponse;
    };


    function asd(a, id) {

        if (a == 1) {
            document.getElementById("asd" + id).style.display = "block";
        } else {
            document.getElementById("asd" + id).style.display = "none";
        }
    };
</script>

</html>